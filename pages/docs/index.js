import React from "react";
import Head from "next/head";
import { SwaggerUIBundle, SwaggerUIStandalonePreset} from "swagger-ui-dist";
import "swagger-ui-dist/swagger-ui.css";

export async function getStaticProps() {
  return {
    props: {
      auth: process.env.AUTH
    }
  }
}

export default function Docs(props) {

  React.useEffect(() => {
    const ui = SwaggerUIBundle({
      url: '/swagger.json',
      dom_id: '#swagger-ui',
      presets: [
        SwaggerUIBundle.presets.apis,
        SwaggerUIStandalonePreset
      ],
      layout: "StandaloneLayout",
      configs: {
        preFetch: function(req) {
          req.headers.Authorization = props.auth
          return req
        }
      },
      onComplete: function() {
        ui.preauthorizeBasic("basicAuth", "admin", "admin");
      }
    })

    window.ui = ui
  })

  return (
    <>
      <Head>
        <title>Docs</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <div>
        <div id="swagger-ui"></div>
      </div>
    </>
  );
}